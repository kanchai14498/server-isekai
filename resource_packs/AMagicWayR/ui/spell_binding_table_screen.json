{
    "namespace": "spell_binding_table",

    "spell_item@common.container_item": {
        "$background_images": "scroll_image.black_cell_image",
        "$item_renderer": "scroll_image.empty"
    },

    "spell_render": {
        "type": "panel",
        "size": [ 18, 18 ],
        "controls": [
            {
                "image@scroll_image.template": {}
            },
            {
                "locked": {
                    "type": "image",
                    "texture": "textures/ui/magic_lock",
                    "size": [ 16, 16 ],
                    "layer": 6,
                    "bindings": [
                        {
                            "binding_name": "#hover_text",
                            "binding_type": "collection",
                            "binding_collection_name": "$item_collection_name"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(not(#hover_text - 'locked' = #hover_text))",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            }
        ]
    },

    "spell_binding_item": {
        "type": "panel",
        "size": [ 0, 0 ],
        "controls": [
            {
                "item_0@common.container_item": {
                    "offset": [ -15, -25 ],
                    "$cell_overlay_ref": "scroll_image.spell_book_overlay",
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 0)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_1@common.container_item": {
                    "offset": [ 15, -25 ],
                    "$cell_overlay_ref": "scroll_image.scroll_overlay",
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 1)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_2@spell_binding_table.spell_item": {
                    "offset": [ -72, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 2)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_3@spell_binding_table.spell_item": {
                    "offset": [ -54, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 3)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_4@spell_binding_table.spell_item": {
                    "offset": [ -36, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 4)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_5@spell_binding_table.spell_item": {
                    "offset": [ -18, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 5)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_6@spell_binding_table.spell_item": {
                    "offset": [ 0, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 6)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_7@spell_binding_table.spell_item": {
                    "offset": [ 18, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 7)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_8@spell_binding_table.spell_item": {
                    "offset": [ 36, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 8)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_9@spell_binding_table.spell_item": {
                    "offset": [ 54, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 9)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_10@spell_binding_table.spell_item": {
                    "offset": [ 72, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 10)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_11": {
                    "type": "panel",
                    "size": [ 160, 156 ],
                    "offset": [ -175, 28 ],
                    "layer": 2,
                    "controls": [
                        {
                            "text@scroll_image.item_name_panel": {
                                "size": [ 160, 156 ]
                            }
                        }
                    ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_control_name": "spell_toggle", 
                            "source_property_name": "#toggle_state", 
                            "target_property_name": "#toggle_state" 
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 11 and #toggle_state)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_12@spell_binding_table.spell_render": {
                    "offset": [ -72, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 12)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_13@spell_binding_table.spell_render": {
                    "offset": [ -54, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 13)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_14@spell_binding_table.spell_render": {
                    "offset": [ -36, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 14)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_15@spell_binding_table.spell_render": {
                    "offset": [ -18, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 15)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_16@spell_binding_table.spell_render": {
                    "offset": [ 0, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 16)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_17@spell_binding_table.spell_render": {
                    "offset": [ 18, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 17)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_18@spell_binding_table.spell_render": {
                    "offset": [ 36, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 18)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_19@spell_binding_table.spell_render": {
                    "offset": [ 54, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 19)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            },
            {
                "item_20@spell_binding_table.spell_render": {
                    "offset": [ 72, 10 ],
                    "bindings": [
                        {
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_name": "#collection_index",
                            "binding_type": "collection_details",
                            "binding_collection_name": "container_items"
                        },
                        {
                            "binding_type": "view",
                            "source_property_name": "(#collection_index = 20)",
                            "target_property_name": "#visible"
                        }
                    ]
                }
            }
        ]
    },

    "spell_binding_table_input": {
        "type": "stack_panel",
        "anchor_from": "center",
        "anchor_to": "center",
        "orientation": "horizontal",
        "size": [ 0, 0 ],
        "$scale": 21,

        "collection_name": "container_items",
        "$item_collection_name": "container_items",
        
        "factory": {
            "name": "spell_binding_table",
            "control_name": "spell_binding_table.spell_binding_item"
        },
        "property_bag": {
            "#scale": "$scale"
        },
        "bindings": [
            {
                "binding_type": "view",
                "source_property_name": "(#scale * 1)",
                "target_property_name": "#collection_length"
            }
        ]
    },

    "layout_toggle_content": {
        "type": "image",
        "offset": [ 0, -1 ],
        "anchor_to": "top_middle",
        "anchor_from": "top_middle",
        "texture": "$icon",
        "size": [ 19, 13 ],
        "layer": 1
    },

    "toolbar": {
        "type": "image",
        "texture": "textures/ui/toolbar_background",
        "size": [
            "100%cm + 17px",
            26
        ],
        "offset": [ 0, 3 ],
        "anchor_from": "top_right",
        "anchor_to": "bottom_right",
        "controls": [
            {
                "inner": {
                    "type": "stack_panel",
                    "orientation": "horizontal",
                    "size": [
                        "100%c",
                        18
                    ],
                    "controls": [
                        {
                            "spell_description@common_toggles.light_image_toggle": {
                                "$toggle_view_binding_name": "spell_toggle",
                                "$icon": "textures/ui/spell_description",
                                "$button_content": "spell_binding_table.layout_toggle_content",
                                "$toggle_name": "layout_toggle",
                                "$button_mappings": [
                                  {
                                    "from_button_id": "button.menu_select",
                                    "to_button_id": "button.menu_select",
                                    "mapping_type": "pressed"
                                  },
                                  {
                                    "from_button_id": "button.menu_ok",
                                    "to_button_id": "button.menu_ok",
                                    "mapping_type": "focused"
                                  },
                                  {
                                    "from_button_id": "button.menu_tab_left",
                                    "to_button_id": "button.spell_toggle",
                                    "mapping_type": "global"
                                  }
                                ],
                                "size": [ 25, 18 ]
                            }
                        },
                        {
                            "space": {
                                "type": "panel",
                                "size": [ 2, 0 ],
                                "bindings": [
                                    {
                                        "binding_name": "#close_button_visible",
                                        "binding_name_override": "#visible"
                                    }
                                ]
                            }
                        },
                        {
                            "close_button_panel": {
                                "type": "panel",
                                "size": [ 15, "100%" ],
                                "bindings": [
                                    {
                                        "binding_name": "#close_button_visible",
                                        "binding_name_override": "#visible"
                                    }
                                ],
                                "controls": [
                                    {
                                        "close_button@common.light_close_button": {
                                            "offset": [ 0, 0 ],
                                            "anchor_from": "center",
                                            "anchor_to": "center"
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            {
                "helper": {
                    "type": "image",
                    "texture": "textures/ui/generic_bumper_left",
                    "anchor_from": "left_middle",
                    "anchor_to": "right_middle",
                    "size": [ 26, 26 ],
                    "offset": [ -1, 0 ],
                    "bindings": [
                        {
                            "binding_name": "(#is_using_gamepad)",
                            "binding_name_override": "#visible"
                        }
                    ]
                }
            }
        ]
    },

    "spell_binding_table_panel": {
        "type": "panel",
        "controls": [
            { "container_gamepad_helpers@common.container_gamepad_helpers": {} },
            { "selected_item_details_factory@common.selected_item_details_factory": {} },
            { "item_lock_notification_factory@common.item_lock_notification_factory": {} },
            {
                "root_panel@common.root_panel": {
                    "layer": 1,
                    "controls": [
                        {
                            "all_panel": {
                                "type": "stack_panel",
                                "size": [
                                    "100%c",
                                    "166px"
                                ],
                                "orientation": "horizontal",
                                "controls": [
                                    {
                                        "spell_book_panel@scroll_image.grey_border": {
                                            "size": [ 170, 166 ],
                                            "bindings": [
                                                {
                                                    "binding_type": "view",
                                                    "source_control_name": "spell_toggle", 
                                                    "source_property_name": "#toggle_state", 
                                                    "target_property_name": "#visible" 
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "space": {
                                            "type": "panel",
                                            "size": [ 2, 166 ],
                                            "bindings": [
                                                {
                                                    "binding_type": "view",
                                                    "source_control_name": "spell_toggle", 
                                                    "source_property_name": "#toggle_state", 
                                                    "target_property_name": "#visible" 
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "main_panel": {
                                            "type": "panel",
                                            "size": [ 177, 166 ],
                                            "controls": [
                                                { 
                                                    "toolbar@spell_binding_table.toolbar": {
                                                    } 
                                                },
                                                { 
                                                    "common_panel@common.common_panel": {
                                                        "$show_close_button": false
                                                    } 
                                                },
                                                {
                                                    "chest_panel": {
                                                        "type": "panel",
                                                        "layer": 5,
                                                        "controls": [
                                                            {
                                                                "small_chest_panel_top_half": {
                                                                    "type": "panel",
                                                                    "size": [ "100%", "50%" ],
                                                                    "offset": [ 0, 12 ],
                                                                    "anchor_to": "top_middle",
                                                                    "anchor_from": "top_middle",
                                                                    "controls": [
                                                                        { 
                                                                            "chest_label": {
                                                                                "type": "label",
                                                                                "offset": [ 0, -5 ],
                                                                                "anchor_from": "top_middle",
                                                                                "anchor_to": "top_middle",
                                                                                "text": "Spell Binding Table",
                                                                                "color": "$title_text_color",
                                                                                "layer": 2
                                                                            }
                                                                        },
                                                                        {
                                                                            "spell_binding_table_input@spell_binding_table.spell_binding_table_input": {
                                                                            }
                                                                        },
                                                                        {
                                                                            "black_border": {
                                                                                "type": "image",
                                                                                "texture": "textures/ui/background_with_border",
                                                                                "layer": 1,
                                                                                "offset": [ 0, 10 ],
                                                                                "size": [ 168, 24 ]
                                                                            }
                                                                        },
                                                                        {
                                                                            "item_cell_bridge": {
                                                                                "type": "image",
                                                                                "texture": "textures/ui/item_cell_bridge",
                                                                                "layer": 5,
                                                                                "offset": [ 0, -25 ],
                                                                                "size": [ 14, 6 ]
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            { "inventory_panel_bottom_half_with_label@common.inventory_panel_bottom_half_with_label": {} },
                                                            { "hotbar_grid@common.hotbar_grid_template": {} },
                                                            { "inventory_take_progress_icon_button@common.inventory_take_progress_icon_button": {} },
                                                            { "flying_item_renderer@common.flying_item_renderer": { "layer": 15 } }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        { "inventory_selected_icon_button@common.inventory_selected_icon_button": {} },
                        { "gamepad_cursor@common.gamepad_cursor_button": {} }
                    ]
                }
            }
        ]
    }
}